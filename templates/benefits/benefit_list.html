{% extends "layout.html" %}
{% block body %}

<h3>Benefits Dashboard</h3>
<hr>

<div class="row mb-3 align-items-center">
  <div class="col-md-6">
    <form method="get" class="d-flex">
      <input type="text" name="q" class="form-control me-2" placeholder="Sicil No or Name"
             value="{{ query|default_if_none:'' }}" style="max-width:280px;">
      <button type="submit" class="btn btn-primary me-2">Search</button>
      <a href="{% url 'benefits:list' %}" class="btn btn-secondary">Clear</a>
    </form>
  </div>
  <div class="col-md-6 text-end">
    <a class="btn btn-success" href="{% url 'benefits:create' %}">+ New</a>
  </div>
</div>

<table class="table table-bordered table-hover">
  <thead class="table-light">
    <tr>
      <th>Sicil No</th>
      <th>Name Surname</th>
      <th>Cost Center</th>
      <th>Group</th>

      <th>Family</th>
      <th>Food</th>
      <th>Gold</th>
      <th>Bayram</th>
      <th>Birth & Marriage</th>
      <th>Funding</th>
      <th>Subsistence</th>
      <th>Fare</th>
      <th>Premium</th>

      <th style="width:140px;">Process</th>
    </tr>
  </thead>
  <tbody>
    {% for b in page_obj %}
    <tr>
      <td>{{ b.worker.sicil_no }}</td>
      <td>{{ b.name_surname }}</td>
      <td>
        {% if b.worker.s_no and b.worker.s_no.code %}
          {{ b.worker.s_no.code }}
        {% else %}
          {{ b.cost_center_id|default_if_none:"" }}
        {% endif %}
      </td>
      <td>{{ b.group_name }}</td>

      <td>{{ b.aile_yakacak|floatformat:2 }}</td>
      <td>{{ b.erzak|floatformat:2 }}</td>
      <td>{{ b.altin|floatformat:2 }}</td>
      <td>{{ b.bayram|floatformat:2 }}</td>
      <td>{{ b.dogum_evlenme|floatformat:2 }}</td>
      <td>{{ b.fon|floatformat:2 }}</td>
      <td>{{ b.harcirah|floatformat:2 }}</td>
      <td>{{ b.yol_parasi|floatformat:2 }}</td>
      <td>{{ b.prim|floatformat:2 }}</td>

      <td class="text-nowrap">
        <div class="d-flex justify-content-start gap-2">
          <a href="{% url 'benefits:update' b.id %}" class="btn btn-sm btn-primary">Update</a>
          <a href="{% url 'benefits:delete' b.id %}" class="btn btn-sm btn-danger"
             onclick="return confirm('Are you sure you want to delete this benefit record?');">Delete</a>
        </div>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="15" class="text-center text-muted">There is no benefits now</td></tr>
    {% endfor %}
  </tbody>
</table>

<nav aria-label="Sayfalama">
  <ul class="pagination justify-content-center">
    {% if page_obj.has_previous %}
      <li class="page-item"><a class="page-link" href="?page=1{% if query %}&q={{query}}{% endif %}">&laquo; First</a></li>
      <li class="page-item"><a class="page-link" href="?page={{page_obj.previous_page_number}}{% if query %}&q={{query}}{% endif %}">Previous</a></li>
    {% endif %}

    <li class="page-item active">
      <span class="page-link">Page {{page_obj.number}} / {{page_obj.paginator.num_pages}}</span>
    </li>

    {% if page_obj.has_next %}
      <li class="page-item"><a class="page-link" href="?page={{page_obj.next_page_number}}{% if query %}&q={{query}}{% endif %}">Next</a></li>
      <li class="page-item"><a class="page-link" href="?page={{page_obj.paginator.num_pages}}{% if query %}&q={{query}}{% endif %}">Last &raquo;</a></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
