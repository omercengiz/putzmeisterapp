{% extends "layout.html" %}

{% block body %}

<h3>Workers</h3>
<hr>
<div class="row mb-3 align-items-center">
  <div class="col-md-6">
    <form method="get" class="d-flex">
      <input type="text" name="q" class="form-control me-2" placeholder="Search by Sicil No" value="{{ query|default_if_none:'' }}" style="width: 200px;">
      <button type="submit" class="btn btn-primary me-2">Search</button>
      <a href="{% url 'workers:dashboard' %}" class="btn btn-secondary">Clear</a>
    </form>
  </div>
  <div class="col-md-6 text-end">
    <a class="btn btn-danger" href="/workers/addworkers">Add a Member</a>
  </div>
</div>
<hr>

<table class="table">
    <thead>
      <tr>
        <th scope="col">id</th>
        <th scope="col">Sicil.No</th>
        <th scope="col">Name Surname</th>
        <th scope="col">Date of Recruitment</th>
        <th scope="col">Group</th>
        <th scope="col">Directorships</th>
        <th scope="col">Masraf Yeri</th>  
        <th scope="col">Department</th>
        <th scope="col">Short Class</th>
        <th scope="col">Work Class</th>
        <th scope="col">Class Name</th>
        <th scope="col">Gross Payment</th>
        <th scope="col">Currency</th>
        <th scope="col">Bonus</th>
      </tr>
    </thead>
    <tbody>
        {% for worker in page_obj %}
        <tr>
            <th scope="row">{{worker.id}}</th>
            <td>{{worker.sicil_no}}</td>
            <td>{{worker.name_surname}}</td>
            <td>{{worker.date_of_recruitment|date:"d.m.Y"}}</td>
            <td>{{worker.group}}</td>
            <td>{{worker.department_short_name}}</td>
            <td>{{worker.s_no}}</td>
            <td>{{worker.department}}</td>
            <td>{{worker.short_class}}</td>
            <td>{{worker.work_class}}</td>
            <td>{{worker.class_name}}</td>
            <td>{{worker.gross_payment}}</td>
            <td>{{worker.currency}}</td>
            <td>None</td>
            <td><a href="/workers/update/{{worker.id}}" class="btn btn-danger">Update</a></td>
            <td><a href="/workers/delete/{{worker.id}}" class="btn btn-danger">Delete</a></td>
        </tr> 
        {% endfor %}
    </tbody>
</table>

<!-- Pagination Controls -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page=1{% if query %}&q={{ query }}{% endif %}">&laquo; First</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if query %}&q={{ query }}{% endif %}">Previous</a>
      </li>
    {% endif %}

    <li class="page-item active">
      <span class="page-link">
        Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
      </span>
    </li>

    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}{% if query %}&q={{ query }}{% endif %}">Next</a>
      </li>
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if query %}&q={{ query }}{% endif %}">Last &raquo;</a>
      </li>
    {% endif %}
  </ul>
</nav>

{% if query and page_obj.paginator.count == 0 %}
  <div class="alert alert-warning mt-3" role="alert">
    <strong>{{ query }}</strong> numaralı Sicil No ile eşleşen bir kayıt bulunamadı.
  </div>
{% endif %}

{% endblock body %}
